{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"mongoose\"","webpack:///./env.js","webpack:///external \"bcryptjs\"","webpack:///./src/server/models/User.ts","webpack:///external \"path\"","webpack:///external \"jsonwebtoken\"","webpack:///./src/server/middleware/authorized.ts","webpack:///external \"validator\"","webpack:///./src/server/models/Message.ts","webpack:///./src/server/server.ts","webpack:///external \"http\"","webpack:///external \"express\"","webpack:///external \"csurf\"","webpack:///external \"cookie-parser\"","webpack:///external \"express-session\"","webpack:///external \"body-parser\"","webpack:///external \"helmet\"","webpack:///external \"compression\"","webpack:///external \"mustache-express\"","webpack:///external \"connect-mongo\"","webpack:///./src/server/routes.ts","webpack:///./src/server/middleware/admin.ts","webpack:///./src/server/controllers/authController.ts","webpack:///./src/server/controllers/userController.ts","webpack:///./src/server/controllers/messageController.ts","webpack:///./src/server/controllers/channelController.ts","webpack:///./src/server/models/Channel.ts","webpack:///./src/server/socket.io/index.ts","webpack:///external \"socket.io\""],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","mongodbConnectionUri","process","env","MONGODB_URI","mongodbTestConnectionUri","MONGODB_TEST_URI","port","PORT","production","useTestDb","USE_TEST_DB","secret","SECRET","disableCsrf","DISABLE_CSRF","disableReduxLogging","DISABLE_REDUX_LOGGING","disableAutoStart","DISABLE_AUTO_START","mailgunApiKey","MAILGUN_API_KEY","mailgunDomain","MAILGUN_DOMAIN","baseUrl","BASE_URL","mongoose_1","userSchema","Schema","String","email","required","type","lowercase","password","role","enum","deleted","Boolean","default","verified","timestamps","statics","findByEmail","this","findOne","User","model","jsonwebtoken_1","req","res","next","token","session","headers","status","json","error","verify","err","decoded","send","user","messageSchema","channel","text","userEmail","Message","__dirname","http","express","path","mongoose","csrf","cookieParser","bodyParser","bcrypt","helmet","compression","mustacheExpress","MongoStore","routes_1","index_1","User_1","app","server","socketServer","engine","set","use","sessionMiddleware","cookie","maxAge","sameSite","secure","httpOnly","saveUninitialized","resave","store","mongooseConnection","connection","csrfMiddleware","connect","useNewUrlParser","on","console","close","log","exit","csrfToken","db","urlencoded","extended","static","resolve","authenticate","done","then","compareSync","Error","userDetails","logout","issueNewToken","sign","expiresIn","setHeader","createServer","listen","emit","conn","authorized_1","admin_1","authController_1","userController_1","messageController_1","channelController_1","render","post","login","register","verifyEmail","users","userByEmail","updateEmail","updateName","updatePassword","resetPassword","createUser","put","editUser","deleteUser","restoreUser","messages","channels","validator_1","bcryptjs_1","isEmpty","body","end","isEmail","success","countDocuments","exec","count","passwordHash","hashSync","emailVerified","save","u","message","find","select","params","_id","created","createdAt","assign","newPass","oldPass","Message_1","skip","parseInt","offest","sort","limit","map","reverse","Channel_1","Promise","reject","delete","channelSchema","Channel","socketio","io","connectedUserEmails","socket","request","push","splice","indexOf"],"mappings":"aACA,IAAAA,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,GAAA,CACAG,EAAAH,EACAI,GAAA,EACAH,QAAA,IAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,IAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CZ,EAAAkB,EAAA,SAAAhB,GACA,oBAAAiB,eAAAC,aACAN,OAAAC,eAAAb,EAAAiB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAb,EAAA,cAAiDmB,OAAA,KAQjDrB,EAAAsB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAArB,EAAAqB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFA1B,EAAAkB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAArB,EAAAU,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAzB,EAAA6B,EAAA,SAAA1B,GACA,IAAAS,EAAAT,KAAAqB,WACA,WAA2B,OAAArB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD/B,EAAAkC,EAAA,GAIAlC,IAAAmC,EAAA,mBClFAhC,EAAAD,QAAAkC,QAAA,6BCAAjC,EAAAD,QAAA,CAEAmC,qBAAAC,QAAAC,IAAAC,YACAC,yBAAAH,QAAAC,IAAAG,kBACA,yCACAC,KAAAL,QAAAC,IAAAK,MAAA,IACAC,YAAgB,EAChBC,UAAAR,QAAAC,IAAAQ,cAAA,EACAC,OAAAV,QAAAC,IAAAU,QAAA,SACAC,YAAAZ,QAAAC,IAAAY,eAAA,EACAC,oBAAAd,QAAAC,IAAAc,wBAAA,EACAC,iBAAAhB,QAAAC,IAAAgB,qBAAA,EACAC,cAAAlB,QAAAC,IAAAkB,gBACAC,cAAApB,QAAAC,IAAAoB,eACAC,QAAAtB,QAAAC,IAAAsB,SAAAvB,QAAAC,IAAAsB,SAAA,wCCdA1D,EAAAD,QAAAkC,QAAA,0CCCAlC,EAAAsB,YAAA,EACA,IAAAsC,EAAiB9D,EAAQ,GAEzB+D,EAAA,IAAAD,EAAAE,OAAA,CACArD,KAAAsD,OACAC,MAAA,CACAC,UAAA,EACAC,KAAAH,OACAI,WAAA,GAEAC,SAAA,CACAF,KAAAH,OACAE,UAAA,GAEAI,KAAA,CACAH,KAAAH,OACAE,UAAA,EACAE,WAAA,EACAG,KAAA,kBAEAC,QAAA,CACAL,KAAAM,QACAC,SAAA,GAEAC,SAAA,CACAR,KAAAM,QACAC,SAAA,IAEC,CACDE,YAAA,IAEAd,EAAAe,QAAAC,YAAA,SAAAb,GACA,OAAAc,KAAAC,QAAA,CAAyBf,WAEzB,IAAAgB,EAAApB,EAAAqB,MAAA,OAAApB,GACA7D,EAAA,QAAAgF,iBCpCA/E,EAAAD,QAAAkC,QAAA,uBCAAjC,EAAAD,QAAAkC,QAAA,8CCCAlC,EAAAsB,YAAA,EACA,IAAA4D,EAAqBpF,EAAQ,GAC7BuC,EAAUvC,EAAQ,GAYlBE,EAAA,QAXA,SAAAmF,EAAAC,EAAAC,GACA,IAAAC,EAAAH,EAAAI,QAAAD,OAAAH,EAAAK,QAAA,kBACA,IAAAF,EACA,OAAAF,EAAAK,OAAA,KAAAC,KAAA,CAAqCC,MAAA,mBACrCT,EAAAU,OAAAN,EAAAjD,EAAAS,OAAA,SAAA+C,EAAAC,GACA,OAAAD,EACAT,EAAAK,OAAA,KAAAM,KAAA,CAAyCJ,MAAA,oBACzCR,EAAAa,KAAAF,EACAT,uBCZApF,EAAAD,QAAAkC,QAAA,2CCCAlC,EAAAsB,YAAA,EACA,IAAAsC,EAAiB9D,EAAQ,GACzBmG,EAAA,IAAArC,EAAAE,OAAA,CACAoC,QAAA,CACAhC,KAAAH,OACAE,UAAA,GAEAkC,KAAA,CACAjC,KAAAH,OACAE,UAAA,GAEAmC,UAAA,CACAlC,KAAAH,OACAE,UAAA,EACAE,WAAA,IAEC,CACDQ,YAAA,IAEA0B,EAAAzC,EAAAqB,MAAA,UAAAgB,GACAjG,EAAA,QAAAqG,iCCrBA,SAAAC,GACAtG,EAAAsB,YAAA,EACA,IAAAiF,EAAWzG,EAAQ,IACnB0G,EAAc1G,EAAQ,IACtB2G,EAAW3G,EAAQ,GACnB4G,EAAe5G,EAAQ,GACvB6G,EAAW7G,EAAQ,IACnB8G,EAAmB9G,EAAQ,IAC3ByF,EAAczF,EAAQ,IACtB+G,EAAiB/G,EAAQ,IACzBgH,EAAahH,EAAQ,GACrBiH,EAAajH,EAAQ,IACrBkH,EAAkBlH,EAAQ,IAC1BoF,EAAqBpF,EAAQ,GAC7BmH,EAAsBnH,EAAQ,IAC9BoH,EAAiBpH,EAAQ,GAARA,CAAuByF,GACxC4B,EAAerH,EAAQ,IACvBsH,EAActH,EAAQ,IACtBuH,EAAavH,EAAQ,GACrBuC,EAAUvC,EAAQ,GAClBwH,EAAAd,IACAxG,EAAAsH,MACA,IACAC,EACAC,EAFA/E,EAAAJ,EAAAI,KAGAzC,EAAAwH,eACAF,EAAAG,OAAA,OAAAR,KACAK,EAAAI,IAAA,sBACAJ,EAAAK,IAAAX,KACA,IAAAY,EAAArC,EAAA,CACAzC,OAAAT,EAAAS,OACA+E,OAAA,CACAC,OAAA,MACAC,UAAA,EACAC,OAAA3F,EAAAM,WACAsF,UAAA,GAEAC,mBAAA,EACAC,QAAA,EACAC,MAAA,IAAAlB,EAAA,CACAmB,mBAAA3B,EAAA4B,eAGAC,EAAA5B,EAAA,CACAkB,OAAA,CACAC,OAAA,MACAC,UAAA,EACAC,OAAA3F,EAAAM,WACAsF,UAAA,EACAxG,IAAA,WAGAiF,EAAA8B,QAAAnG,EAAAO,UAAAP,EAAAE,yBAAAF,EAAAF,qBAAA,CAA2FsG,iBAAA,IAC3F/B,EAAA4B,WAAAI,GAAA,iBAAA7C,GACA8C,QAAAhD,MAAA,4BAAAE,KAEAzD,QAAAsG,GAAA,oBACAhC,EAAA4B,WAAAM,MAAA,WACAD,QAAAE,IAAA,oEACAtB,EAAAqB,MAAA,WACAxG,QAAA0G,KAAA,SAIAxB,EAAAK,IAAAC,GACAN,EAAAK,IAAAf,EAAAvE,EAAAS,SACAT,EAAAW,aACA2F,QAAAE,IAAA,iBACAvB,EAAAK,IAAA,SAAAxC,EAAAC,EAAAC,GAEA,OADAF,EAAA4D,UAAA,WAAqC,UACrC1D,OAIAiC,EAAAK,IAAAY,GAEA,IAAAS,EAAAtC,EAAA4B,WACAhB,EAAAK,IAAA,SAAAxC,EAAAC,EAAAC,GAEA,OADAF,EAAA6D,KACA3D,MAEAiC,EAAAK,IAAAd,EAAAnB,QACA4B,EAAAK,IAAAd,EAAAoC,WAAA,CAA+BC,UAAA,KAC/B5B,EAAAK,IAAAZ,KACAO,EAAAK,IAAAnB,EAAA2C,OAAA1C,EAAA2C,QAAA9C,EAAA,wBACAgB,EAAAK,IAAA,gBAAAxC,EAAAC,EAAAC,GACA,OAAAA,MAEAiC,EAAAK,IAAA,SAAAxC,EAAAC,EAAAC,GACAF,EAAAkE,aAAA,SAAArF,EAAAI,EAAAkF,GACAjC,EAAA,QAAAxC,YAAAb,GAAAuF,KAAA,SAAAvD,GACA,UAAAA,EACA,OAAAsD,GAAA,QACA,IAAAxC,EAAA0C,YAAApF,EAAA4B,EAAA5B,UACA,OAAAkF,GAAA,MAAAG,MAAA,qBACA,IAAAC,EAAA,CACA1F,MAAAgC,EAAAhC,MACAvD,KAAAuF,EAAAvF,KACA4D,KAAA2B,EAAA3B,MAEA,OAAAiF,EAAAI,EAAA,QACS,eAAA7D,GACTyD,GAAA,EAAAzD,MAGAV,EAAAwE,OAAA,WACAxE,EAAAI,QAAAD,MAAA,MAEAH,EAAAyE,cAAA,SAAA5D,GACA,IAAAV,EAAAJ,EAAA2E,KAAA,CACApJ,KAAAuF,EAAAvF,KACA4D,KAAA2B,EAAA3B,KACAL,MAAAgC,EAAAhC,OACS3B,EAAAS,OAAA,CACTgH,UAAA,QAEA1E,EAAA2E,UAAA,iBAAAzE,GACAH,EAAAI,QAAAD,SAEAD,MAEA8B,EAAA,QAAAG,IACAC,EAAAhB,EAAAyD,aAAA1C,IACAoB,GAAA,iBAAA7C,GACA8C,QAAAhD,MAAAE,GACA0B,EAAAqB,UAEAvG,EAAAe,mBACApD,EAAAwH,eAAAJ,EAAA,QAAAG,EAAAyB,EAAApB,GACAlB,EAAA4B,WAAAI,GAAA,uBACAC,QAAAE,IAAA,qCACAtB,EAAA0C,OAAAxH,EAAA,WACAkG,QAAAE,IAAA,qBAAApG,EAAA,KACA6E,EAAA4C,KAAA,uBAIAlK,EAAA,QAAAuH,EACAvH,EAAAmK,KAAAzD,EAAA4B,oDC1IArI,EAAAD,QAAAkC,QAAA,uBCAAjC,EAAAD,QAAAkC,QAAA,0BCAAjC,EAAAD,QAAAkC,QAAA,wBCAAjC,EAAAD,QAAAkC,QAAA,gCCAAjC,EAAAD,QAAAkC,QAAA,kCCAAjC,EAAAD,QAAAkC,QAAA,8BCAAjC,EAAAD,QAAAkC,QAAA,yBCAAjC,EAAAD,QAAAkC,QAAA,8BCAAjC,EAAAD,QAAAkC,QAAA,mCCAAjC,EAAAD,QAAAkC,QAAA,gDCAA,SAAAoE,GACAtG,EAAAsB,YAAA,EACA,IAAAmF,EAAW3G,EAAQ,GACnBsK,EAAmBtK,EAAQ,GAC3BuK,EAAcvK,EAAQ,IACtBwK,EAAuBxK,EAAQ,IAC/ByK,EAAuBzK,EAAQ,IAC/B0K,EAA0B1K,EAAQ,IAClC2K,EAA0B3K,EAAQ,IAqClCE,EAAA,QApCA,SAAAsH,GACAA,EAAAvG,IAAA,aAAAoE,EAAAC,GACA,OAAAA,EAAAsF,OAAAjE,EAAA2C,QAAA9C,EAAA,iCAAoFyC,UAAA5D,EAAA4D,gBAEpFzB,EAAAvG,IAAA,mBAAAoE,EAAAC,GACA,OAAAA,EAAAsF,OAAAjE,EAAA2C,QAAA9C,EAAA,6CAEAgB,EAAAvG,IAAA,wBAAAoE,EAAAC,GACA,OAAAA,EAAAsF,OAAAjE,EAAA2C,QAAA9C,EAAA,4CAEAgB,EAAAqD,KAAA,gBAAAL,EAAA,QAAAM,OACAtD,EAAAqD,KAAA,mBAAAL,EAAA,QAAAO,UACAvD,EAAAvG,IAAA,iBAAAuJ,EAAA,QAAAX,QACArC,EAAAvG,IAAA,0BAAAuJ,EAAA,QAAAQ,aACAxD,EAAAK,IAAA,gBAAAyC,EAAA,SACA9C,EAAAvG,IAAA,eAAAwJ,EAAA,QAAAvE,MACAsB,EAAAvG,IAAA,gBAAAwJ,EAAA,QAAAQ,OACAzD,EAAAvG,IAAA,qBAAAwJ,EAAA,QAAAS,aACA1D,EAAAqD,KAAA,4BAAAJ,EAAA,QAAAU,aACA3D,EAAAqD,KAAA,2BAAAJ,EAAA,QAAAW,YACA5D,EAAAqD,KAAA,+BAAAJ,EAAA,QAAAY,gBACA7D,EAAAqD,KAAA,8BAAAJ,EAAA,QAAAa,eACA9D,EAAAqD,KAAA,sBAAAN,EAAA,QAAAE,EAAA,QAAAc,YACA/D,EAAAgE,IAAA,sBAAAjB,EAAA,QAAAE,EAAA,QAAAgB,UACAjE,EAAA,6BAAA+C,EAAA,QAAAE,EAAA,QAAAiB,YACAlE,EAAAgE,IAAA,uBAAAjB,EAAA,QAAAE,EAAA,QAAAkB,aACAnE,EAAAK,IAAA,mBAAAyC,EAAA,SACA9C,EAAAvG,IAAA,oCAAAyJ,EAAA,QAAAkB,UACApE,EAAAK,IAAA,kBAAAyC,EAAA,SACA9C,EAAAvG,IAAA,mBAAA0J,EAAA,QAAAkB,UACArE,EAAAqD,KAAA,0BAAAN,EAAA,QAAAI,EAAA,gBACAnD,EAAAqD,KAAA,0BAAAN,EAAA,QAAAI,EAAA,QAAAjJ,QACA8F,EAAAvG,IAAA,aAAAoE,EAAAC,GACA,OAAAA,EAAAsF,OAAAjE,EAAA2C,QAAA9C,EAAA,iCAAoFyC,UAAA5D,EAAA4D,yECzCpF/I,EAAAsB,YAAA,EAOAtB,EAAA,QANA,SAAAmF,EAAAC,EAAAC,GACA,OAAAF,EAAAa,MAAA,UAAAb,EAAAa,KAAA3B,KACAgB,IAEAD,EAAAK,OAAA,KAAAC,KAAA,CAAiCC,MAAA,2DCLjC3F,EAAAsB,YAAA,EACA,IAAAsK,EAAkB9L,EAAQ,GAC1B+L,EAAiB/L,EAAQ,GACzBuH,EAAavH,EAAQ,GACXA,EAAQ,GAClBE,EAAA,SACA4K,MAAA,SAAAzF,EAAAC,GACA,OAAAwG,EAAAE,QAAA3G,EAAA4G,KAAA/H,OAAA,KAAA4H,EAAAE,QAAA3G,EAAA4G,KAAA3H,UAAA,IACAgB,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,wCAA+CqG,MAExFJ,EAAAK,QAAA9G,EAAA4G,KAAA/H,YAGAmB,EAAAkE,aAAAlE,EAAA4G,KAAA/H,MAAAmB,EAAA4G,KAAA3H,SAAA,SAAA4B,GACA,OAAAA,GAEAb,EAAAyE,cAAA5D,GACAZ,EAAAK,OAAA,KACAC,KAAA,CACAwG,SAAA,EACAlI,MAAAgC,EAAAhC,MACAK,KAAA2B,EAAA3B,KACA5D,KAAAuF,EAAAvF,OACauL,OARb5G,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,8BAAqCqG,QAJlF5G,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,8BAAqCqG,OAe9EnB,SAAA,SAAA1F,EAAAC,GACA,OAAAwG,EAAAE,QAAA3G,EAAA4G,KAAA/H,OAAA,KAAA4H,EAAAE,QAAA3G,EAAA4G,KAAA3H,UAAA,IACAgB,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,wCAEzCiG,EAAAK,QAAA9G,EAAA4G,KAAA/H,OAGAqD,EAAA,QAAAxC,YAAAM,EAAA4G,KAAA/H,OAAAmI,iBAAAC,OAAA7C,KAAA,SAAA8C,GACA,OAAAA,EACA,OAAAjH,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,yBAC7C,IAAA2G,EAAAT,EAAAU,SAAApH,EAAA4G,KAAA3H,UACAiD,EAAA,QAAA8E,iBAAAC,OAAA7C,KAAA,SAAA8C,GACA,IAAAhI,EAAA,OACA,IAAAgI,IACAhI,EAAA,SACA,IAAAgD,EAAA,SACA5G,KAAA,GACAuD,MAAAmB,EAAA4G,KAAA/H,MACAI,SAAAkI,EACAjI,OACAmI,eAAA,IAEAC,OAAAlD,KAAA,SAAAmD,GACA,OAAAtH,EAAAK,OAAA,KAAAC,KAAA,CAAiDwG,SAAA,MAChC,eAAArG,GAEjB,OADA8C,QAAAhD,MAAAE,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAAiDC,MAAA,2DArBjDP,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,+BA0BzCgE,OAAA,SAAAxE,EAAAC,GAEA,OADAD,EAAAwE,SACAvE,EAAAM,KAAA,CAAyBwG,SAAA,EAAAS,QAAA,gBAEzB7B,YAAA,SAAA3F,EAAAC,oCC7DApF,EAAAsB,YAAA,EACA,IAAAsK,EAAkB9L,EAAQ,GAC1BuH,EAAavH,EAAQ,GACrB+L,EAAiB/L,EAAQ,GACzBE,EAAA,SACAgG,KAAA,SAAAb,EAAAC,GACAA,EAAAW,KAAAZ,EAAAa,OAEA+E,MAAA,SAAA5F,EAAAC,GACA,OAAAiC,EAAA,QAAAuF,KAAA,IAAwCC,OAAA,2BAAAtD,KAAA,SAAAwB,GACxC,OAAA3F,EAAAK,OAAA,KAAAC,KAAA,CAAyCwG,SAAA,EAAAnB,YAChC,eAAAlF,GAET,OADA8C,QAAAhD,MAAAE,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,mDAGzCqF,YAAA,SAAA7F,EAAAC,GACA,OAAAwG,EAAAK,QAAA9G,EAAA2H,OAAA9G,MAEAqB,EAAA,QAAAxC,YAAAM,EAAA2H,OAAA9G,MAAAoG,OAAA7C,KAAA,SAAAvD,GACA,cAAAA,EACAZ,EAAAK,OAAA,KAAAC,KAAA,CACAM,KAAA,CACAhC,MAAAgC,EAAAhC,MACA+I,IAAA/G,EAAA+G,IACAtM,KAAAuF,EAAAvF,MAAA,GACA4D,KAAA2B,EAAA3B,KACA2I,QAAAhH,EAAAiH,aAIA7H,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,oCAChC,eAAAE,GAET,OADA8C,QAAAhD,MAAAE,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,mDAhBzCP,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,iCAmBzCsF,YAAA,SAAA9F,EAAAC,GACA,OAAAwG,EAAAK,QAAA9G,EAAA4G,KAAA/H,OAEAqD,EAAA,QAAA8E,eAAA,CAAiDnI,MAAAmB,EAAA4G,KAAA/H,QAAwBoI,OAAA7C,KAAA,SAAA8C,GACzE,WAAAA,EACAjH,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,iCAC7C0B,EAAA,QAAAxC,YAAAM,EAAAa,KAAAhC,OAAAoI,OAAA7C,KAAA,SAAAvD,GAIA,OAHAA,EAAAhC,MAAAmB,EAAA4G,KAAA/H,MACAgC,EAAAyG,OACAtH,EAAAyE,cAAAhJ,OAAAsM,OAAA,GAAkD/H,EAAAa,KAAA,CAAahC,MAAAmB,EAAA4G,KAAA/H,SAC/DoB,EAAAK,OAAA,KAAAC,KAAA,CAA6CwG,SAAA,MAChC,eAAArG,GAEb,OADA8C,QAAAhD,MAAAE,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,sDAX7CP,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,uBAezCuF,WAAA,SAAA/F,EAAAC,GACA,OAAAiC,EAAA,QAAAxC,YAAAM,EAAAa,KAAAhC,OACAoI,OAAA7C,KAAA,SAAAvD,GAIA,OAHAA,EAAAvF,KAAA0E,EAAA4G,KAAAtL,KACAuF,EAAAyG,OACAtH,EAAAyE,cAAAhJ,OAAAsM,OAAA,GAA8C/H,EAAAa,KAAA,CAAavF,KAAA0E,EAAA4G,KAAAtL,QAC3D2E,EAAAK,OAAA,KAAAC,KAAA,CAAyCwG,SAAA,MAChC,eAAArG,GAET,OADA8C,QAAAhD,MAAAE,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,sDAGzCwF,eAAA,SAAAhG,EAAAC,GACA,OAAAwG,EAAAE,QAAA3G,EAAA4G,KAAAoB,UAAAvB,EAAAE,QAAA3G,EAAA4G,KAAAqB,SACAhI,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,6CACzC0B,EAAA,QAAAxC,YAAAM,EAAAa,KAAAhC,OAAAoI,OAAA7C,KAAA,SAAAvD,GACA,OAAA6F,EAAArC,YAAArE,EAAA4G,KAAAqB,QAAApH,EAAA5B,WAEA4B,EAAA5B,SAAAyH,EAAAU,SAAApH,EAAA4G,KAAAoB,SACAnH,EAAAyG,OACArH,EAAAK,OAAA,KAAAC,KAAA,CAAyCwG,SAAA,KAHzC9G,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,qCAM7CyF,cAAA,SAAAjG,EAAAC,GACA,OAAAA,EAAAK,OAAA,KAAAC,KAAA,CAAqCC,MAAA,qBAErC0F,WAAA,SAAAlG,EAAAC,GACA,OAAAwG,EAAAE,QAAA3G,EAAA4G,KAAA/H,SAAA4H,EAAAK,QAAA9G,EAAA4G,KAAA/H,QACA4H,EAAAE,QAAA3G,EAAA4G,KAAA1H,OAAA,SAAAc,EAAA4G,KAAA1H,MAAA,UAAAc,EAAA4G,KAAA1H,KACAe,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,qCACzC0B,EAAA,QAAAxC,YAAAM,EAAA4G,KAAA/H,OAAAmI,eAAA,SAAAtG,EAAAtF,GACA,OAAAsF,GACA8C,QAAAhD,MAAA,yDAAAR,EAAA4G,KAAA/H,MAAA6B,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,0BAE7C,IAAApF,EACA6E,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,yBAC7C,IAAA0B,EAAA,SACArD,MAAAmB,EAAA4G,KAAA/H,MACAvD,KAAA0E,EAAA4G,KAAAtL,MAAA,GACA4D,KAAAc,EAAA4G,KAAA1H,KACAD,SAAA,SAEAqI,KAAA,SAAA5G,EAAA6G,GACA,OAAA7G,GACA8C,QAAAhD,MAAA,2CAAAE,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAAiDC,MAAA,0BAEjDP,EAAAK,OAAA,KAAAC,KAAA,CAA6CwG,SAAA,SAI7CX,SAAA,SAAApG,EAAAC,GACA,OAAAD,EAAA4G,KAAA/H,OAAA4H,EAAAK,QAAA9G,EAAA4G,KAAA/H,OAEAmB,EAAA4G,KAAA/F,KAAAhC,QAAA4H,EAAAK,QAAA9G,EAAA4G,KAAA/F,KAAAhC,OACAoB,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,gCACzCR,EAAA4G,KAAA/F,KAAA3B,OAAAuH,EAAAE,QAAA3G,EAAA4G,KAAA/F,KAAA3B,OAAA,SAAAc,EAAA4G,KAAA/F,KAAA3B,MAAA,UAAAc,EAAA4G,KAAA/F,KAAA3B,KACAe,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,iBACzC0B,EAAA,QAAAxC,YAAAM,EAAA4G,KAAA/H,OAAAoI,KAAA,SAAAvG,EAAAG,GACA,OAAAH,GACA8C,QAAAE,IAAA,uBAAAhD,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,0BAE7CK,GAGAb,EAAA4G,KAAA/F,KAAAhC,QACAgC,EAAAhC,MAAAmB,EAAA4G,KAAA/F,KAAAhC,OACAmB,EAAA4G,KAAA/F,KAAAvF,OACAuF,EAAAvF,KAAA0E,EAAA4G,KAAA/F,KAAAvF,MACA0E,EAAA4G,KAAA/F,KAAA3B,OACA2B,EAAA3B,KAAAc,EAAA4G,KAAA/F,KAAA3B,MACA2B,EAAAyG,KAAA,SAAA5G,EAAAG,GACA,OAAAH,GACA8C,QAAAE,IAAAhD,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAAiDC,MAAA,0BAEjDP,EAAAK,OAAA,KAAAC,KAAA,CAA6CwG,SAAA,OAb7C9G,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,0BAX7CP,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,iCA4BzC6F,WAAA,SAAArG,EAAAC,GACA,OAAAD,EAAA4G,KAAA/H,OAAA4H,EAAAK,QAAA9G,EAAA4G,KAAA/H,OAEAqD,EAAA,QAAAxC,YAAAM,EAAA4G,KAAA/H,OAAAoI,KAAA,SAAAvG,EAAAG,GACA,OAAAH,GACA8C,QAAAE,IAAA,uBAAAhD,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,0BAE7CK,EAEAA,EAAAzB,QACAa,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,yBAC7CR,EAAAa,KAAAhC,QAAAmB,EAAA4G,KAAA/H,MACAoB,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,gCAC7CK,EAAAzB,SAAA,EACAyB,EAAAyG,KAAA,SAAA5G,GACA,OAAAT,EAAAK,OAAA,KAAAC,KAAA,CAA6CwG,SAAA,OAP7C9G,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,0BAP7CP,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,wCAkBzC8F,YAAA,SAAAtG,EAAAC,GACA,OAAAD,EAAA4G,KAAA/H,OAAA4H,EAAAK,QAAA9G,EAAA4G,KAAA/H,OAEAqD,EAAA,QAAAxC,YAAAM,EAAA4G,KAAA/H,OAAAoI,KAAA,SAAAvG,EAAAG,GACA,OAAAH,GACA8C,QAAAE,IAAA,uBAAAhD,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,0BAE7CK,EAEAA,EAAAzB,SAEAyB,EAAAzB,SAAA,EACAyB,EAAAyG,KAAA,SAAA5G,GACA,OAAAT,EAAAK,OAAA,KAAAC,KAAA,CAA6CwG,SAAA,OAH7C9G,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,wBAF7CP,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,0BAP7CP,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,uEC9JzC3F,EAAAsB,YAAA,EACA,IAAA+L,EAAgBvN,EAAQ,GACxBE,EAAA,SACA0L,SAAA,SAAAvG,EAAAC,GACA,OAAAiI,EAAA,QAAAT,KAAA,CAA0C1G,QAAAf,EAAA2H,OAAA5G,UAC1CoH,KAAAC,SAAApI,EAAA2H,OAAAU,SACAC,KAAA,CAAmBV,KAAA,IACnBW,MAAA,IACAtB,OAAA7C,KAAA,SAAAmC,GACA,OAAAtG,EAAAK,OAAA,KAAAC,KAAA,CACAgG,WAAAiC,IAAA,SAAArN,GACA,OACA6F,KAAA7F,EAAA6F,KACA6G,QAAA1M,EAAA2M,UACA7G,UAAA9F,EAAA8F,UACAF,QAAA5F,EAAA4F,QACA6G,IAAAzM,EAAAyM,OAEiBa,cAER,eAAA/H,GACT,OAAAT,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,oFCrBzC3F,EAAAsB,YAAA,EACA,IAAAuM,EAAgB/N,EAAQ,IACxBE,EAAA,SACA2L,SAAA,SAAAxG,EAAAC,GACA,OAAAyI,EAAA,QAAA1B,iBAAAC,OAAA7C,KAAA,SAAA8C,GAWA,OAVA,IAAAyB,QAAA,SAAA1E,EAAA2E,GACA,OAAA1B,EACA,OAAAjD,IAEAyE,EAAA,QAAArM,OAAA,EAA8Cf,KAAA,WAAkB,CAAGA,KAAA,YAAiB8I,KAAA,WACpF,OAAAH,MACiB,eAAAvD,GACjB,OAAAkI,EAAAlI,OAGA0D,KAAA,WACAsE,EAAA,QAAAjB,OAAAR,OAAA7C,KAAA,SAAAoC,GACA,OAAAvG,EAAAK,OAAA,KAAAC,KAAA,CAAiDiG,eAChC,eAAA9F,GAEjB,OADA8C,QAAAE,IAAAhD,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAAiDC,MAAA,4DAEpC,eAAAE,GAEb,OADA8C,QAAAhD,MAAAE,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAA6CC,MAAA,qEAEpC,eAAAE,GAET,OADA8C,QAAAhD,MAAAE,GACAT,EAAAK,OAAA,KAAAC,KAAA,CAAyCC,MAAA,oDAGzCqI,OAAA,SAAA7I,EAAAC,KAEA5D,OAAA,SAAA2D,EAAAC,oCCjCApF,EAAAsB,YAAA,EACA,IAAAsC,EAAiB9D,EAAQ,GACzBmO,EAAA,IAAArK,EAAAE,OAAA,CACArD,KAAA,CACAyD,KAAAH,OACAE,UAAA,EACAE,WAAA,IAEC,CACDQ,YAAA,IAEAuJ,EAAAtK,EAAAqB,MAAA,UAAAgJ,GACAjO,EAAA,QAAAkO,gCCZAlO,EAAAsB,YAAA,EACA,IAAA6M,EAAerO,EAAQ,IACvBuN,EAAgBvN,EAAQ,GACxBsK,EAAmBtK,EAAQ,GACjBA,EAAQ,GA0ClBE,EAAA,QAzCA,SAAAuH,EAAAyB,EAAApB,GACA,IAAAwG,EAAAD,EAAA5G,GACA8G,EAAA,GAqCA,OApCAD,EAAAzG,IAAA,SAAA2G,EAAAjJ,GACAuC,EAAA0G,EAAAC,QAAA,GAA4ClJ,KAE5C+I,EAAAzG,IAAA,SAAA2G,EAAAjJ,GACA+E,EAAA,QAAAkE,EAAAC,QAAA,GAAkDlJ,KAElD+I,EAAA1F,GAAA,sBAAA4F,GACAD,EAAAG,KAAAF,EAAAC,QAAAvI,KAAAhC,OACA2E,QAAAE,IAAA,kBAAAwF,GACAD,EAAAlE,KAAA,kBAAAmE,GACAC,EAAA5F,GAAA,wBACA2F,EAAAI,OAAAJ,EAAAK,QAAAJ,EAAAC,QAAAvI,KAAAhC,OAAA,GACAoK,EAAAlE,KAAA,kBAAAmE,KAEAC,EAAA5F,GAAA,mBAAAiE,GACAhE,QAAAE,IAAA8D,GACA,IAAAU,EAAA,SACAnH,QAAAyG,EAAAzG,QACAC,KAAAwG,EAAAxG,KACAC,UAAAkI,EAAAC,QAAAvI,KAAAhC,QAEAyI,OAAAlD,KAAA,SAAAjJ,GACA8N,EAAAlE,KAAA,WACA6C,IAAAzM,EAAAyM,IACA3G,UAAA9F,EAAA8F,UACAD,KAAA7F,EAAA6F,KACAD,QAAA5F,EAAA4F,QACA8G,QAAA1M,EAAA2M,YAEAqB,EAAApE,KAAA,sBACa,eAAArE,GACb8C,QAAAhD,MAAAE,GACAyI,EAAApE,KAAA,wBAAArE,SAIAuI,kBC7CAnO,EAAAD,QAAAkC,QAAA","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n","module.exports = require(\"mongoose\");","module.exports = {\n    // https://docs.mongodb.com/manual/reference/connection-string/\n    mongodbConnectionUri: process.env.MONGODB_URI,\n    mongodbTestConnectionUri: process.env.MONGODB_TEST_URI ||\n\t\t\t      'mongodb://localhost:27017/openChatTest',\n    port: process.env.PORT || 5000,\n    production: process.env.NODE_ENV === 'production' || false,\n    useTestDb: process.env.USE_TEST_DB || false,\n    secret: process.env.SECRET || 'secret',\n    disableCsrf: process.env.DISABLE_CSRF || false,\n    disableReduxLogging: process.env.DISABLE_REDUX_LOGGING || false,\n    disableAutoStart: process.env.DISABLE_AUTO_START || false,\n    mailgunApiKey: process.env.MAILGUN_API_KEY,\n    mailgunDomain: process.env.MAILGUN_DOMAIN,\n    baseUrl: process.env.BASE_URL ? process.env.BASE_URL : 'http://localhost:5000'\n}\n","module.exports = require(\"bcryptjs\");","\"use strict\";\nexports.__esModule = true;\nvar mongoose_1 = require(\"mongoose\");\n;\nvar userSchema = new mongoose_1.Schema({\n    name: String,\n    email: {\n        required: true,\n        type: String,\n        lowercase: true\n    },\n    password: {\n        type: String,\n        required: true\n    },\n    role: {\n        type: String,\n        required: true,\n        lowercase: true,\n        \"enum\": ['admin', 'user']\n    },\n    deleted: {\n        type: Boolean,\n        \"default\": false\n    },\n    verified: {\n        type: Boolean,\n        \"default\": false,\n    },\n}, {\n    timestamps: true\n});\nuserSchema.statics.findByEmail = function (email) {\n    return this.findOne({ email: email });\n};\nvar User = mongoose_1.model('User', userSchema);\nexports[\"default\"] = User;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVXNlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9zZXJ2ZXIvbW9kZWxzL1VzZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxxQ0FBOEU7QUFZN0UsQ0FBQztBQU1GLElBQU0sVUFBVSxHQUFXLElBQUksaUJBQU0sQ0FBQztJQUNsQyxJQUFJLEVBQUUsTUFBTTtJQUNaLEtBQUssRUFBRTtRQUNILFFBQVEsRUFBRSxJQUFJO1FBQ2QsSUFBSSxFQUFFLE1BQU07UUFDWixTQUFTLEVBQUUsSUFBSTtLQUNsQjtJQUNELFFBQVEsRUFBRTtRQUNOLElBQUksRUFBRSxNQUFNO1FBQ1osUUFBUSxFQUFFLElBQUk7S0FDakI7SUFDRCxJQUFJLEVBQUU7UUFDRixJQUFJLEVBQUUsTUFBTTtRQUNaLFFBQVEsRUFBRSxJQUFJO1FBQ2QsU0FBUyxFQUFFLElBQUk7UUFDZixNQUFJLEVBQUUsQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDO0tBQzFCO0lBQ0QsT0FBTyxFQUFFO1FBQ0wsSUFBSSxFQUFFLE9BQU87UUFDYixTQUFPLEVBQUUsS0FBSztLQUNqQjtJQUNELFFBQVEsRUFBRTtRQUNOLElBQUksRUFBRSxPQUFPO1FBQ2IsU0FBTyxFQUFFLEtBQUs7S0FDakI7Q0FDSixFQUFFO0lBQ0MsVUFBVSxFQUFFLElBQUk7Q0FDbkIsQ0FBQyxDQUFDO0FBRUgsVUFBVSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEdBQUcsVUFBVSxLQUFhO0lBQ3BELE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFDLEtBQUssRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDO0FBQ3hDLENBQUMsQ0FBQTtBQUVELElBQU0sSUFBSSxHQUFlLGdCQUFLLENBQW9CLE1BQU0sRUFBRSxVQUFVLENBQUMsQ0FBQztBQUN0RSxxQkFBZSxJQUFJLENBQUMifQ==","module.exports = require(\"path\");","module.exports = require(\"jsonwebtoken\");","\"use strict\";\nexports.__esModule = true;\nvar jsonwebtoken_1 = require(\"jsonwebtoken\");\nvar env = require('../../../env');\nfunction default_1(req, res, next) {\n    var token = req.session.token || req.headers['x-access-token'];\n    if (!token)\n        return res.status(401).json({ error: 'Not authorized' });\n    jsonwebtoken_1.verify(token, env.secret, function (err, decoded) {\n        if (err)\n            return res.status(401).send({ error: 'Not authorized' });\n        req.user = decoded;\n        return next();\n    });\n}\nexports[\"default\"] = default_1;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aG9yaXplZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9zZXJ2ZXIvbWlkZGxld2FyZS9hdXRob3JpemVkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsNkNBQXNDO0FBR3RDLElBQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQztBQUNwQyxtQkFBd0IsR0FBWSxFQUFFLEdBQW1CLEVBQUUsSUFBYztJQUNyRSxJQUFJLEtBQUssR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDLEtBQUssSUFBSSxHQUFHLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLENBQUM7SUFDL0QsSUFBSSxDQUFDLEtBQUs7UUFDTixPQUFPLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxFQUFFLGdCQUFnQixFQUFFLENBQUMsQ0FBQztJQUU3RCxxQkFBTSxDQUFDLEtBQUssRUFBRSxHQUFHLENBQUMsTUFBTSxFQUFFLFVBQUMsR0FBVSxFQUFFLE9BQWM7UUFDakQsSUFBSSxHQUFHO1lBQUUsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssRUFBRSxnQkFBZ0IsRUFBRSxDQUFDLENBQUM7UUFDbEUsR0FBRyxDQUFDLElBQUksR0FBRyxPQUFPLENBQUM7UUFDbkIsT0FBTyxJQUFJLEVBQUUsQ0FBQztJQUNsQixDQUFDLENBQUMsQ0FBQztBQUNQLENBQUM7QUFWRCwrQkFVQyJ9","module.exports = require(\"validator\");","\"use strict\";\nexports.__esModule = true;\nvar mongoose_1 = require(\"mongoose\");\nvar messageSchema = new mongoose_1.Schema({\n    channel: {\n        type: String,\n        required: true,\n    },\n    text: {\n        type: String,\n        required: true,\n    },\n    userEmail: {\n        type: String,\n        required: true,\n        lowercase: true,\n    }\n}, {\n    timestamps: true\n});\nvar Message = mongoose_1.model('Message', messageSchema);\nexports[\"default\"] = Message;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWVzc2FnZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9zZXJ2ZXIvbW9kZWxzL01lc3NhZ2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxxQ0FBd0Q7QUFVeEQsSUFBTSxhQUFhLEdBQVcsSUFBSSxpQkFBTSxDQUFDO0lBQ3JDLE9BQU8sRUFBRTtRQUNMLElBQUksRUFBRSxNQUFNO1FBQ1osUUFBUSxFQUFFLElBQUk7S0FFakI7SUFDRCxJQUFJLEVBQUU7UUFDRixJQUFJLEVBQUUsTUFBTTtRQUNaLFFBQVEsRUFBRSxJQUFJO0tBQ2pCO0lBQ0QsU0FBUyxFQUFFO1FBQ1AsSUFBSSxFQUFFLE1BQU07UUFDWixRQUFRLEVBQUUsSUFBSTtRQUNkLFNBQVMsRUFBRSxJQUFJO0tBRWxCO0NBQ0osRUFBRTtJQUNDLFVBQVUsRUFBRSxJQUFJO0NBQ25CLENBQUMsQ0FBQztBQUVILElBQU0sT0FBTyxHQUFvQixnQkFBSyxDQUFDLFNBQVMsRUFBRSxhQUFhLENBQUMsQ0FBQztBQUNqRSxxQkFBZSxPQUFPLENBQUMifQ==","\"use strict\";\nexports.__esModule = true;\nvar http = require(\"http\");\nvar express = require(\"express\");\nvar path = require(\"path\");\nvar mongoose = require(\"mongoose\");\nvar csrf = require(\"csurf\");\nvar cookieParser = require(\"cookie-parser\");\nvar session = require(\"express-session\");\nvar bodyParser = require(\"body-parser\");\nvar bcrypt = require(\"bcryptjs\");\nvar helmet = require(\"helmet\");\nvar compression = require(\"compression\");\nvar jsonwebtoken_1 = require(\"jsonwebtoken\");\nvar mustacheExpress = require('mustache-express');\nvar MongoStore = require('connect-mongo')(session);\nvar routes_1 = require(\"./routes\");\nvar index_1 = require(\"./socket.io/index\");\nvar User_1 = require(\"./models/User\");\nvar env = require('../../env');\nvar app = express();\nexports.app = app;\nvar port = env.port;\nvar server;\nvar socketServer;\nexports.socketServer = socketServer;\napp.engine('html', mustacheExpress());\napp.set('view engine', 'html');\napp.use(compression());\nvar sessionMiddleware = session({\n    secret: env.secret,\n    cookie: {\n        maxAge: 24 * 60 * 60 * 1000,\n        sameSite: true,\n        secure: env.production,\n        httpOnly: true\n    },\n    saveUninitialized: true,\n    resave: false,\n    store: new MongoStore({\n        mongooseConnection: mongoose.connection\n    })\n});\nvar csrfMiddleware = csrf({\n    cookie: {\n        maxAge: 24 * 60 * 60 * 1000,\n        sameSite: true,\n        secure: env.production,\n        httpOnly: true,\n        key: '_csrf'\n    }\n});\nmongoose.connect(env.useTestDb ? env.mongodbTestConnectionUri : env.mongodbConnectionUri, { useNewUrlParser: true });\nmongoose.connection.on('error', function (err) {\n    console.error('Mongoose connection error', err);\n});\nprocess.on('SIGINT', function () {\n    mongoose.connection.close(function () {\n        console.log('Mongoose default connection disconnected through app termination');\n        server.close(function () {\n            process.exit(0);\n        });\n    });\n});\napp.use(sessionMiddleware);\napp.use(cookieParser(env.secret));\nif (env.disableCsrf) {\n    console.log('CSRF disabled');\n    app.use(function (req, res, next) {\n        req.csrfToken = function () { return ''; };\n        return next();\n    });\n}\nelse {\n    app.use(csrfMiddleware);\n}\nvar db = mongoose.connection;\napp.use(function (req, res, next) {\n    req.db = db;\n    return next();\n});\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(helmet());\napp.use(express.static(path.resolve(__dirname, '../../dist/public/')));\napp.use('/api', function (req, res, next) {\n    return next();\n});\napp.use(function (req, res, next) {\n    req.authenticate = function (email, password, done) {\n        User_1[\"default\"].findByEmail(email).then(function (user) {\n            if (user === null)\n                return done(false, null);\n            if (!bcrypt.compareSync(password, user.password))\n                return done(false, new Error('Invalid password'));\n            var userDetails = {\n                email: user.email,\n                name: user.name,\n                role: user.role,\n            };\n            return done(userDetails, null);\n        })[\"catch\"](function (err) {\n            done(false, err);\n        });\n    };\n    req.logout = function () {\n        req.session.token = null;\n    };\n    req.issueNewToken = function (user) {\n        var token = jsonwebtoken_1.sign({\n            name: user.name,\n            role: user.role,\n            email: user.email\n        }, env.secret, {\n            expiresIn: 86400\n        });\n        res.setHeader('x-access-token', token);\n        req.session.token = token;\n    };\n    next();\n});\nroutes_1[\"default\"](app);\nserver = http.createServer(app);\nserver.on('error', function (err) {\n    console.error(err);\n    server.close();\n});\nif (!env.disableAutoStart) {\n    exports.socketServer = socketServer = index_1[\"default\"](server, db, sessionMiddleware);\n    mongoose.connection.on('connected', function () {\n        console.log('Connected to MongoDB via Mongoose');\n        server.listen(port, function () {\n            console.log(\"Listening on port \" + port + \"!\");\n            app.emit('server started');\n        });\n    });\n}\nexports[\"default\"] = server;\nexports.conn = mongoose.connection;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VydmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3NlcnZlci9zZXJ2ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFFQSwyQkFBNkI7QUFDN0IsaUNBQW1DO0FBQ25DLDJCQUE2QjtBQUU3QixtQ0FBcUM7QUFDckMsNEJBQThCO0FBQzlCLDRDQUE4QztBQUM5Qyx5Q0FBMkM7QUFDM0Msd0NBQTBDO0FBQzFDLGlDQUFtQztBQUNuQywrQkFBaUM7QUFFakMseUNBQTJDO0FBQzNDLDZDQUFvQztBQUNwQyxJQUFNLGVBQWUsR0FBRyxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQztBQUNwRCxJQUFNLFVBQVUsR0FBRyxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUM7QUFFckQsbUNBQThCO0FBQzlCLDJDQUEwQztBQUUxQyxzQ0FBNEM7QUFDNUMsSUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBRWpDLElBQU0sR0FBRyxHQUFRLE9BQU8sRUFBRSxDQUFDO0FBc0lsQixrQkFBRztBQXJJWixJQUFNLElBQUksR0FBb0IsR0FBRyxDQUFDLElBQUksQ0FBQztBQUN2QyxJQUFJLE1BQW1CLENBQUM7QUFDeEIsSUFBSSxZQUE2QixDQUFDO0FBbUlwQixvQ0FBWTtBQWpJMUIsR0FBRyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsZUFBZSxFQUFFLENBQUMsQ0FBQztBQUN0QyxHQUFHLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxNQUFNLENBQUMsQ0FBQztBQUUvQixHQUFHLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7QUFFdkIsSUFBTSxpQkFBaUIsR0FBRyxPQUFPLENBQUM7SUFDOUIsTUFBTSxFQUFFLEdBQUcsQ0FBQyxNQUFNO0lBQ2xCLE1BQU0sRUFBRTtRQUNKLE1BQU0sRUFBRSxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJO1FB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","module.exports = require(\"http\");","module.exports = require(\"express\");","module.exports = require(\"csurf\");","module.exports = require(\"cookie-parser\");","module.exports = require(\"express-session\");","module.exports = require(\"body-parser\");","module.exports = require(\"helmet\");","module.exports = require(\"compression\");","module.exports = require(\"mustache-express\");","module.exports = require(\"connect-mongo\");","\"use strict\";\nexports.__esModule = true;\nvar path = require(\"path\");\nvar authorized_1 = require(\"./middleware/authorized\");\nvar admin_1 = require(\"./middleware/admin\");\nvar authController_1 = require(\"./controllers/authController\");\nvar userController_1 = require(\"./controllers/userController\");\nvar messageController_1 = require(\"./controllers/messageController\");\nvar channelController_1 = require(\"./controllers/channelController\");\nfunction default_1(app) {\n    app.get('/', function (req, res) {\n        return res.render(path.resolve(__dirname, '../../dist/public/index.html'), { csrfToken: req.csrfToken() });\n    });\n    app.get('/widget', function (req, res) {\n        return res.render(path.resolve(__dirname, '../../../dist/public/widget/index.html'));\n    });\n    app.get('/widget/demo', function (req, res) {\n        return res.render(path.resolve(__dirname, '../../../dist/public/widget/demo.html'));\n    });\n    app.post('/api/v1/login', authController_1[\"default\"].login);\n    app.post('/api/v1/register', authController_1[\"default\"].register);\n    app.get('/api/v1/logout', authController_1[\"default\"].logout);\n    app.get('/api/v1/verifyEmail/:id', authController_1[\"default\"].verifyEmail);\n    app.use('/api/v1/user*', authorized_1[\"default\"]);\n    app.get('/api/v1/user', userController_1[\"default\"].user);\n    app.get('/api/v1/users', userController_1[\"default\"].users);\n    app.get('/api/v1/user/:user', userController_1[\"default\"].userByEmail);\n    app.post('/api/v1/user/update/email', userController_1[\"default\"].updateEmail);\n    app.post('/api/v1/user/update/name', userController_1[\"default\"].updateName);\n    app.post('/api/v1/user/update/password', userController_1[\"default\"].updatePassword);\n    app.post('/api/v1/user/reset_password', userController_1[\"default\"].resetPassword);\n    app.post('/api/v1/user/create', admin_1[\"default\"], userController_1[\"default\"].createUser);\n    app.put('/api/v1/user/update', admin_1[\"default\"], userController_1[\"default\"].editUser);\n    app[\"delete\"]('/api/v1/user/delete', admin_1[\"default\"], userController_1[\"default\"].deleteUser);\n    app.put('/api/v1/user/restore', admin_1[\"default\"], userController_1[\"default\"].restoreUser);\n    app.use('/api/v1/message*', authorized_1[\"default\"]);\n    app.get('/api/v1/messages/:channel/:offset', messageController_1[\"default\"].messages);\n    app.use('/api/v1/channel', authorized_1[\"default\"]);\n    app.get('/api/v1/channels', channelController_1[\"default\"].channels);\n    app.post('/api/v1/channels/delete', admin_1[\"default\"], channelController_1[\"default\"][\"delete\"]);\n    app.post('/api/v1/channels/create', admin_1[\"default\"], channelController_1[\"default\"].create);\n    app.get('*', function (req, res) {\n        return res.render(path.resolve(__dirname, '../../dist/public/index.html'), { csrfToken: req.csrfToken() });\n    });\n}\nexports[\"default\"] = default_1;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3NlcnZlci9yb3V0ZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwyQkFBNkI7QUFFN0Isc0RBQWlEO0FBQ2pELDRDQUF1QztBQUN2QywrREFBMEQ7QUFDMUQsK0RBQTBEO0FBQzFELHFFQUFnRTtBQUNoRSxxRUFBZ0U7QUFFaEUsbUJBQXdCLEdBQVE7SUFHNUIsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsVUFBVSxHQUFZLEVBQUUsR0FBYTtRQUM5QyxPQUFPLEdBQUcsQ0FBQyxNQUFNLENBQ2IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsOEJBQThCLENBQUMsRUFDdkQsRUFBRSxTQUFTLEVBQUUsR0FBRyxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQ2pDLENBQUM7SUFDTixDQUFDLENBQUMsQ0FBQztJQUVILEdBQUcsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLFVBQVUsR0FBUSxFQUFFLEdBQVE7UUFDM0MsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUNiLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLHdDQUF3QyxDQUFDLENBQ3BFLENBQUM7SUFDTixDQUFDLENBQUMsQ0FBQztJQUVILEdBQUcsQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLFVBQVUsR0FBUSxFQUFFLEdBQVE7UUFDaEQsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUNiLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLHVDQUF1QyxDQUFDLENBQ25FLENBQUM7SUFDTixDQUFDLENBQUMsQ0FBQztJQUlILEdBQUcsQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLDJCQUFjLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDaEQsR0FBRyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsRUFBRSwyQkFBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3RELEdBQUcsQ0FBQyxHQUFHLENBQUMsZ0JBQWdCLEVBQUUsMkJBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNqRCxHQUFHLENBQUMsR0FBRyxDQUFDLHlCQUF5QixFQUFFLDJCQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7SUFFL0QsR0FBRyxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsdUJBQVUsQ0FBQyxDQUFDO0lBQ3JDLEdBQUcsQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLDJCQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDN0MsR0FBRyxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsMkJBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQTtJQUM5QyxHQUFHLENBQUMsR0FBRyxDQUFDLG9CQUFvQixFQUFFLDJCQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDMUQsR0FBRyxDQUFDLElBQUksQ0FBQywyQkFBMkIsRUFBRSwyQkFBYyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ2xFLEdBQUcsQ0FBQyxJQUFJLENBQUMsMEJBQTBCLEVBQUUsMkJBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUNoRSxHQUFHLENBQUMsSUFBSSxDQUFDLDhCQUE4QixFQUFFLDJCQUFjLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDeEUsR0FBRyxDQUFDLElBQUksQ0FBQyw2QkFBNkIsRUFBRSwyQkFBYyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQ3RFLEdBQUcsQ0FBQyxJQUFJLENBQUMscUJBQXFCLEVBQUUsa0JBQUssRUFBRSwyQkFBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQ2xFLEdBQUcsQ0FBQyxHQUFHLENBQUMscUJBQXFCLEVBQUUsa0JBQUssRUFBRSwyQkFBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQy9ELEdBQUcsQ0FBQyxRQUFNLENBQUEsQ0FBQyxxQkFBcUIsRUFBRSxrQkFBSyxFQUFFLDJCQUFjLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDcEUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsRUFBRSxrQkFBSyxFQUFFLDJCQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7SUFFbkUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsRUFBRSx1QkFBVSxDQUFDLENBQUM7SUFDeEMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxtQ0FBbUMsRUFBRSw4QkFBaUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUV6RSxHQUFHLENBQUMsR0FBRyxDQUFDLGlCQUFpQixFQUFFLHVCQUFVLENBQUMsQ0FBQztJQUN2QyxHQUFHLENBQUMsR0FBRyxDQUFDLGtCQUFrQixFQUFFLDhCQUFpQixDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3hELEdBQUcsQ0FBQyxJQUFJLENBQUMseUJBQXlCLEVBQUUsa0JBQUssRUFBRSw4QkFBaUIsQ0FBQyxRQUFNLENBQUEsQ0FBQyxDQUFDO0lBQ3JFLEdBQUcsQ0FBQyxJQUFJLENBQUMseUJBQXlCLEVBQUUsa0JBQUssRUFBRSw4QkFBaUIsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUdyRSxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxVQUFVLEdBQVksRUFBRSxHQUFhO1FBQzlDLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FDYixJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSw4QkFBOEIsQ0FBQyxFQUN2RCxFQUFFLFNBQVMsRUFBRSxHQUFHLENBQUMsU0FBUyxFQUFFLEVBQUUsQ0FDakMsQ0FBQztJQUNOLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQXpERCwrQkF5REMifQ==","\"use strict\";\nexports.__esModule = true;\nfunction default_1(req, res, next) {\n    if (req.user && req.user.role === 'admin') {\n        return next();\n    }\n    return res.status(401).json({ error: 'Not authorized as admin' });\n}\nexports[\"default\"] = default_1;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWRtaW4uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvc2VydmVyL21pZGRsZXdhcmUvYWRtaW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxtQkFBd0IsR0FBUSxFQUFFLEdBQVEsRUFBRSxJQUFjO0lBQ3RELElBQUksR0FBRyxDQUFDLElBQUksSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxPQUFPLEVBQUU7UUFDdkMsT0FBTyxJQUFJLEVBQUUsQ0FBQztLQUNqQjtJQUNELE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFLLEVBQUUseUJBQXlCLEVBQUUsQ0FBQyxDQUFDO0FBQ3RFLENBQUM7QUFMRCwrQkFLQyJ9","\"use strict\";\nexports.__esModule = true;\nvar validator_1 = require(\"validator\");\nvar bcryptjs_1 = require(\"bcryptjs\");\nvar User_1 = require(\"../models/User\");\nvar env = require('../../../env');\nexports[\"default\"] = {\n    login: function (req, res) {\n        if (validator_1.isEmpty(req.body.email || '') || validator_1.isEmpty(req.body.password || '')) {\n            return res.status(400).json({ error: 'Please supply an email and password' }).end();\n        }\n        if (!validator_1.isEmail(req.body.email)) {\n            return res.status(400).json({ error: 'Not a valid email address' }).end();\n        }\n        req.authenticate(req.body.email, req.body.password, function (user) {\n            if (!user)\n                return res.status(401).json({ error: 'Invalid email or password' }).end();\n            req.issueNewToken(user);\n            return res.status(200)\n                .json({\n                success: true,\n                email: user.email,\n                role: user.role,\n                name: user.name\n            }).end();\n        });\n    },\n    register: function (req, res) {\n        if (validator_1.isEmpty(req.body.email || '') || validator_1.isEmpty(req.body.password || '')) {\n            return res.status(400).json({ error: 'Please supply an email and password' });\n        }\n        if (!validator_1.isEmail(req.body.email)) {\n            return res.status(400).json({ error: 'Not a valid email address' });\n        }\n        return User_1[\"default\"].findByEmail(req.body.email).countDocuments().exec().then(function (count) {\n            if (count !== 0)\n                return res.status(400).json({ error: 'Email address in use' });\n            var passwordHash = bcryptjs_1.hashSync(req.body.password);\n            User_1[\"default\"].countDocuments().exec().then(function (count) {\n                var role = 'user';\n                if (count === 0)\n                    role = 'admin';\n                var user = new User_1[\"default\"]({\n                    name: '',\n                    email: req.body.email,\n                    password: passwordHash,\n                    role: role,\n                    emailVerified: false,\n                });\n                user.save().then(function (u) {\n                    return res.status(200).json({ success: true });\n                })[\"catch\"](function (err) {\n                    console.error(err);\n                    return res.status(500).json({ error: 'Something went wrong trying to create a new user' });\n                });\n            });\n        });\n    },\n    logout: function (req, res) {\n        req.logout();\n        return res.json({ success: true, message: 'logged out' });\n    },\n    verifyEmail: function (req, res) {\n    }\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aENvbnRyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvc2VydmVyL2NvbnRyb2xsZXJzL2F1dGhDb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsdUNBQTZDO0FBQzdDLHFDQUFvQztBQUVwQyx1Q0FBNkM7QUFDN0MsSUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBRXBDLHFCQUFlO0lBQ1gsS0FBSyxFQUFFLFVBQUMsR0FBWSxFQUFFLEdBQWE7UUFDL0IsSUFBSSxtQkFBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxJQUFJLEVBQUUsQ0FBQyxJQUFJLG1CQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUksRUFBRSxDQUFDLEVBQUU7WUFDbkUsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssRUFBRSxxQ0FBcUMsRUFBRSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUM7U0FDdkY7UUFDRCxJQUFJLENBQUMsbUJBQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFO1lBQzFCLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFLLEVBQUUsMkJBQTJCLEVBQUUsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDO1NBQzdFO1FBQ0QsR0FBRyxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxVQUFDLElBQW1CO1lBQ3BFLElBQUksQ0FBQyxJQUFJO2dCQUNMLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFLLEVBQUUsMkJBQTJCLEVBQUUsQ0FBQyxDQUFD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","\"use strict\";\nexports.__esModule = true;\nvar validator_1 = require(\"validator\");\nvar User_1 = require(\"../models/User\");\nvar bcryptjs_1 = require(\"bcryptjs\");\nexports[\"default\"] = {\n    user: function (req, res) {\n        res.send(req.user);\n    },\n    users: function (req, res) {\n        return User_1[\"default\"].find({}).select('name email role deleted').then(function (users) {\n            return res.status(200).json({ success: true, users: users });\n        })[\"catch\"](function (err) {\n            console.error(err);\n            return res.status(500).json({ error: 'Something went wrong while retrieving users' });\n        });\n    },\n    userByEmail: function (req, res) {\n        if (!validator_1.isEmail(req.params.user))\n            return res.status(400).json({ error: 'Please supply a valid email' });\n        return User_1[\"default\"].findByEmail(req.params.user).exec().then(function (user) {\n            if (user !== null) {\n                return res.status(200).json({\n                    user: {\n                        email: user.email,\n                        _id: user._id,\n                        name: user.name || '',\n                        role: user.role,\n                        created: user.createdAt\n                    }\n                });\n            }\n            return res.status(400).json({ error: 'No user found with that email' });\n        })[\"catch\"](function (err) {\n            console.error(err);\n            return res.status(500).json({ error: 'Something went wrong trying to find the user' });\n        });\n    },\n    updateEmail: function (req, res) {\n        if (!validator_1.isEmail(req.body.email))\n            return res.status(400).json({ error: 'Not a valid email' });\n        return User_1[\"default\"].countDocuments({ email: req.body.email }).exec().then(function (count) {\n            if (count !== 0)\n                return res.status(400).json({ error: 'Email address already in use' });\n            return User_1[\"default\"].findByEmail(req.user.email).exec().then(function (user) {\n                user.email = req.body.email;\n                user.save();\n                req.issueNewToken(Object.assign({}, req.user, { email: req.body.email }));\n                return res.status(200).json({ success: true });\n            })[\"catch\"](function (err) {\n                console.error(err);\n                return res.status(500).json({ error: 'Something went wrong trying to fetch the user' });\n            });\n        });\n    },\n    updateName: function (req, res) {\n        return User_1[\"default\"].findByEmail(req.user.email)\n            .exec().then(function (user) {\n            user.name = req.body.name;\n            user.save();\n            req.issueNewToken(Object.assign({}, req.user, { name: req.body.name }));\n            return res.status(200).json({ success: true });\n        })[\"catch\"](function (err) {\n            console.error(err);\n            return res.status(500).json({ error: 'Something went wrong trying to update the user' });\n        });\n    },\n    updatePassword: function (req, res) {\n        if (validator_1.isEmpty(req.body.newPass) || validator_1.isEmpty(req.body.oldPass))\n            return res.status(400).json({ error: 'Must supply the current and new password' });\n        return User_1[\"default\"].findByEmail(req.user.email).exec().then(function (user) {\n            if (!bcryptjs_1.compareSync(req.body.oldPass, user.password))\n                return res.status(400).json({ error: 'Current password is incorrect' });\n            user.password = bcryptjs_1.hashSync(req.body.newPass);\n            user.save();\n            return res.status(200).json({ success: true });\n        });\n    },\n    resetPassword: function (req, res) {\n        return res.status(500).json({ error: 'Not implemented' });\n    },\n    createUser: function (req, res) {\n        if (validator_1.isEmpty(req.body.email) || !validator_1.isEmail(req.body.email) ||\n            validator_1.isEmpty(req.body.role) || (req.body.role !== 'user' && req.body.role !== 'admin'))\n            return res.status(400).json({ error: 'Must supply valid email and role' });\n        return User_1[\"default\"].findByEmail(req.body.email).countDocuments(function (err, c) {\n            if (err) {\n                console.error('Something went wrong trying to count users with email ' + req.body.email, err);\n                return res.status(500).json({ error: 'Something went wrong' });\n            }\n            if (c !== 0)\n                return res.status(400).json({ error: 'Email address in use' });\n            var u = new User_1[\"default\"]({\n                email: req.body.email,\n                name: req.body.name || '',\n                role: req.body.role,\n                password: 'temp',\n            });\n            return u.save(function (err, u) {\n                if (err) {\n                    console.error('Something went wrong trying to save user', err);\n                    return res.status(500).json({ error: 'Something went wrong' });\n                }\n                return res.status(200).json({ success: true });\n            });\n        });\n    },\n    editUser: function (req, res) {\n        if (!req.body.email || !validator_1.isEmail(req.body.email))\n            return res.status(400).json({ error: 'Please supply a valid email' });\n        if (req.body.user.email && !validator_1.isEmail(req.body.user.email))\n            return res.status(400).json({ error: 'Please supply a valid email' });\n        if (req.body.user.role && !validator_1.isEmpty(req.body.user.role) && (req.body.user.role !== 'user' && req.body.user.role !== 'admin'))\n            return res.status(400).json({ error: 'Invalid role' });\n        return User_1[\"default\"].findByEmail(req.body.email).exec(function (err, user) {\n            if (err) {\n                console.log('Something went wrong', err);\n                return res.status(500).json({ error: 'Something went wrong' });\n            }\n            if (!user) {\n                return res.status(404).json({ error: 'User does not exist' });\n            }\n            if (req.body.user.email)\n                user.email = req.body.user.email;\n            if (req.body.user.name)\n                user.name = req.body.user.name;\n            if (req.body.user.role)\n                user.role = req.body.user.role;\n            return user.save(function (err, user) {\n                if (err) {\n                    console.log(err);\n                    return res.status(500).json({ error: 'Something went wrong' });\n                }\n                return res.status(200).json({ success: true });\n            });\n        });\n    },\n    deleteUser: function (req, res) {\n        if (!req.body.email || !validator_1.isEmail(req.body.email))\n            return res.status(400).json({ error: 'Invalid data for parameter \"email\"' });\n        return User_1[\"default\"].findByEmail(req.body.email).exec(function (err, user) {\n            if (err) {\n                console.log('Something went wrong', err);\n                return res.status(500).json({ error: 'Something went wrong' });\n            }\n            if (!user)\n                return res.status(404).json({ error: 'User does not exist' });\n            if (user.deleted)\n                return res.status(400).json({ error: 'User already deleted' });\n            if (req.user.email === req.body.email)\n                return res.status(400).json({ error: 'Cannot delete current user' });\n            user.deleted = true;\n            return user.save(function (err) {\n                return res.status(200).json({ success: true });\n            });\n        });\n    },\n    restoreUser: function (req, res) {\n        if (!req.body.email || !validator_1.isEmail(req.body.email))\n            return res.status(400).json({ error: 'Invalid data for parameter \"email\"' });\n        return User_1[\"default\"].findByEmail(req.body.email).exec(function (err, user) {\n            if (err) {\n                console.log('Something went wrong', err);\n                return res.status(500).json({ error: 'Something went wrong' });\n            }\n            if (!user)\n                return res.status(404).json({ error: 'User does not exist' });\n            if (!user.deleted)\n                return res.status(400).json({ error: 'User already active' });\n            user.deleted = false;\n            return user.save(function (err) {\n                return res.status(200).json({ success: true });\n            });\n        });\n    }\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlckNvbnRyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvc2VydmVyL2NvbnRyb2xsZXJzL3VzZXJDb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsdUNBQTJDO0FBRTNDLHVDQUF5RDtBQUN6RCxxQ0FBK0M7QUFFL0MscUJBQWU7SUFDWCxJQUFJLEVBQUUsVUFBQyxHQUFZLEVBQUUsR0FBYTtRQUM5QixHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN2QixDQUFDO0lBQ0QsS0FBSyxFQUFFLFVBQUMsR0FBWSxFQUFFLEdBQWE7UUFDL0IsT0FBTyxpQkFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMseUJBQXlCLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQyxLQUFjO1lBQ3ZFLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDO1FBQy9ELENBQUMsQ0FBQyxDQUFDLE9BQUssQ0FBQSxDQUFDLFVBQUMsR0FBVTtZQUNoQixPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ25CLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBQyxLQUFLLEVBQUUsNkNBQTZDLEVBQUMsQ0FBQyxDQUFDO1FBQ3hGLENBQUMsQ0FBQyxDQUFBO0lBQ04sQ0FBQztJQUNELFdBQVcsRUFBRSxVQUFDLEdBQVksRUFBRSxHQUFhO1FBQ3JDLElBQUcsQ0FBQyxtQkFBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDO1lBQ3hCLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBQyxL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","\"use strict\";\nexports.__esModule = true;\nvar Message_1 = require(\"../models/Message\");\nexports[\"default\"] = {\n    messages: function (req, res) {\n        return Message_1[\"default\"].find({ channel: req.params.channel })\n            .skip(parseInt(req.params.offest))\n            .sort({ _id: -1 })\n            .limit(20)\n            .exec().then(function (messages) {\n            return res.status(200).json({\n                messages: messages.map(function (m) {\n                    return {\n                        text: m.text,\n                        created: m.createdAt,\n                        userEmail: m.userEmail,\n                        channel: m.channel,\n                        _id: m._id\n                    };\n                }).reverse()\n            });\n        })[\"catch\"](function (err) {\n            return res.status(400).json({ error: 'something went wrong trying to fetch messages' });\n        });\n    }\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzc2FnZUNvbnRyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvc2VydmVyL2NvbnRyb2xsZXJzL21lc3NhZ2VDb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsNkNBQW9EO0FBQ3BELHFCQUFlO0lBQ1gsUUFBUSxFQUFFLFVBQUMsR0FBWSxFQUFFLEdBQWE7UUFDbEMsT0FBTyxvQkFBTyxDQUFDLElBQUksQ0FBQyxFQUFDLE9BQU8sRUFBRSxHQUFHLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBQyxDQUFDO2FBQzdDLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQzthQUNqQyxJQUFJLENBQUMsRUFBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUMsQ0FBQzthQUNmLEtBQUssQ0FBQyxFQUFFLENBQUM7YUFDVCxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsVUFBQyxRQUFvQjtZQUM5QixPQUFPLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDO2dCQUN2QixRQUFRLEVBQUUsUUFBUSxDQUFDLEdBQUcsQ0FBQyxVQUFDLENBQVc7b0JBQ2hDLE9BQU87d0JBQ0gsSUFBSSxFQUFFLENBQUMsQ0FBQyxJQUFJO3dCQUNaLE9BQU8sRUFBRSxDQUFDLENBQUMsU0FBUzt3QkFDcEIsU0FBUyxFQUFFLENBQUMsQ0FBQyxTQUFTO3dCQUN0QixPQUFPLEVBQUUsQ0FBQyxDQUFDLE9BQU87d0JBQ2xCLEdBQUcsRUFBRSxDQUFDLENBQUMsR0FBRztxQkFDYixDQUFDO2dCQUNMLENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRTthQUNmLENBQUMsQ0FBQTtRQUNYLENBQUMsQ0FBQyxDQUFDLE9BQUssQ0FBQSxDQUFDLFVBQUMsR0FBVTtZQUNoQixPQUFPLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxFQUFFLCtDQUErQyxFQUFFLENBQUMsQ0FBQztRQUM1RixDQUFDLENBQUMsQ0FBQTtJQUNOLENBQUM7Q0FDSixDQUFBIn0=","\"use strict\";\nexports.__esModule = true;\nvar Channel_1 = require(\"../models/Channel\");\nexports[\"default\"] = {\n    channels: function (req, res) {\n        return Channel_1[\"default\"].countDocuments().exec().then(function (count) {\n            var p = new Promise(function (resolve, reject) {\n                if (count !== 0) {\n                    return resolve();\n                }\n                Channel_1[\"default\"].create([{ name: 'general' }, { name: 'random' }]).then(function () {\n                    return resolve();\n                })[\"catch\"](function (err) {\n                    return reject(err);\n                });\n            });\n            return p.then(function () {\n                Channel_1[\"default\"].find().exec().then(function (channels) {\n                    return res.status(200).json({ channels: channels });\n                })[\"catch\"](function (err) {\n                    console.log(err);\n                    return res.status(500).json({ error: 'Something went wrong while trying to fetch channels' });\n                });\n            })[\"catch\"](function (err) {\n                console.error(err);\n                return res.status(500).json({ error: 'Something went wrong while trying to create default channels' });\n            });\n        })[\"catch\"](function (err) {\n            console.error(err);\n            return res.status(500).json({ error: 'Something went wrong while counting channels' });\n        });\n    },\n    \"delete\": function (req, res) {\n    },\n    create: function (req, res) {\n    }\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhbm5lbENvbnRyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvc2VydmVyL2NvbnRyb2xsZXJzL2NoYW5uZWxDb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsNkNBQW9EO0FBRXBELHFCQUFlO0lBQ1gsUUFBUSxFQUFFLFVBQUMsR0FBWSxFQUFFLEdBQWE7UUFFbEMsT0FBTyxvQkFBTyxDQUFDLGNBQWMsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxVQUFDLEtBQWE7WUFDdEQsSUFBSSxDQUFDLEdBQUcsSUFBSSxPQUFPLENBQUMsVUFBQyxPQUFPLEVBQUUsTUFBTTtnQkFDaEMsSUFBSSxLQUFLLEtBQUssQ0FBQyxFQUFFO29CQUNiLE9BQU8sT0FBTyxFQUFFLENBQUM7aUJBQ3BCO2dCQUNELG9CQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBQyxJQUFJLEVBQUUsU0FBUyxFQUFDLEVBQUUsRUFBQyxJQUFJLEVBQUUsUUFBUSxFQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztvQkFDdkQsT0FBTyxPQUFPLEVBQUUsQ0FBQztnQkFDckIsQ0FBQyxDQUFDLENBQUMsT0FBSyxDQUFBLENBQUMsVUFBQyxHQUFVO29CQUNoQixPQUFPLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDdkIsQ0FBQyxDQUFDLENBQUM7WUFDUCxDQUFDLENBQUMsQ0FBQztZQUNILE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQztnQkFDVixvQkFBTyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxVQUFDLFFBQW9CO29CQUM1QyxPQUFPLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUMsUUFBUSxFQUFFLFFBQVEsRUFBQyxDQUFDLENBQUM7Z0JBQ3RELENBQUMsQ0FBQyxDQUFDLE9BQUssQ0FBQSxDQUFDLFVBQUMsR0FBVTtvQkFDaEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztvQkFDakIsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssRUFBRSxxREFBcUQsRUFBRSxDQUFDLENBQUM7Z0JBQ2xHLENBQUMsQ0FBQyxDQUFDO1lBQ1AsQ0FBQyxDQUFDLENBQUMsT0FBSyxDQUFBLENBQUMsVUFBQyxHQUFVO2dCQUNoQixPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNuQixPQUFPLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUMsS0FBSyxFQUFFLDhEQUE4RCxFQUFDLENBQUMsQ0FBQztZQUN6RyxDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQyxDQUFDLE9BQUssQ0FBQSxDQUFDLFVBQUMsR0FBVTtZQUNoQixPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ25CLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBQyxLQUFLLEVBQUUsOENBQThDLEVBQUMsQ0FBQyxDQUFDO1FBQ3pGLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUNELFFBQU0sRUFBRSxVQUFDLEdBQVksRUFBRSxHQUFhO0lBRXBDLENBQUM7SUFDRCxNQUFNLEVBQUUsVUFBQyxHQUFZLEVBQUUsR0FBYTtJQUVwQyxDQUFDO0NBQ0osQ0FBQSJ9","\"use strict\";\nexports.__esModule = true;\nvar mongoose_1 = require(\"mongoose\");\nvar channelSchema = new mongoose_1.Schema({\n    name: {\n        type: String,\n        required: true,\n        lowercase: true,\n    },\n}, {\n    timestamps: true\n});\nvar Channel = mongoose_1.model('Channel', channelSchema);\nexports[\"default\"] = Channel;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2hhbm5lbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9zZXJ2ZXIvbW9kZWxzL0NoYW5uZWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxxQ0FBd0Q7QUFReEQsSUFBTSxhQUFhLEdBQVcsSUFBSSxpQkFBTSxDQUFDO0lBQ3JDLElBQUksRUFBRTtRQUNGLElBQUksRUFBRSxNQUFNO1FBQ1osUUFBUSxFQUFFLElBQUk7UUFDZCxTQUFTLEVBQUUsSUFBSTtLQUNsQjtDQUNKLEVBQUU7SUFDQyxVQUFVLEVBQUUsSUFBSTtDQUNuQixDQUFDLENBQUM7QUFFSCxJQUFNLE9BQU8sR0FBb0IsZ0JBQUssQ0FBQyxTQUFTLEVBQUUsYUFBYSxDQUFDLENBQUM7QUFDakUscUJBQWUsT0FBTyxDQUFDIn0=","\"use strict\";\nexports.__esModule = true;\nvar socketio = require(\"socket.io\");\nvar Message_1 = require(\"../models/Message\");\nvar authorized_1 = require(\"../middleware/authorized\");\nvar env = require('../../../env');\nvar init = function (server, db, sessionMiddleware) {\n    var io = socketio(server);\n    var connectedUserEmails = [];\n    io.use(function (socket, next) {\n        sessionMiddleware(socket.request, {}, next);\n    });\n    io.use(function (socket, next) {\n        authorized_1[\"default\"](socket.request, {}, next);\n    });\n    io.on('connection', function (socket) {\n        connectedUserEmails.push(socket.request.user.email);\n        console.log('Connected users', connectedUserEmails);\n        io.emit('connected users', connectedUserEmails);\n        socket.on('disconnect', function () {\n            connectedUserEmails.splice(connectedUserEmails.indexOf(socket.request.user.email), 1);\n            io.emit('connected users', connectedUserEmails);\n        });\n        socket.on('message', function (message) {\n            console.log(message);\n            var m = new Message_1[\"default\"]({\n                channel: message.channel,\n                text: message.text,\n                userEmail: socket.request.user.email\n            });\n            m.save().then(function (m) {\n                io.emit('message', {\n                    _id: m._id,\n                    userEmail: m.userEmail,\n                    text: m.text,\n                    channel: m.channel,\n                    created: m.createdAt\n                });\n                socket.emit('message received');\n            })[\"catch\"](function (err) {\n                console.error(err);\n                socket.emit('message receive error', err);\n            });\n        });\n    });\n    return io;\n};\nexports[\"default\"] = init;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvc2VydmVyL3NvY2tldC5pby9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG9DQUFzQztBQUd0Qyw2Q0FBc0Q7QUFFdEQsdURBQTREO0FBRTVELElBQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQztBQU1wQyxJQUFNLElBQUksR0FBRyxVQUFDLE1BQWMsRUFBRSxFQUFjLEVBQUUsaUJBQXNCO0lBQ2hFLElBQU0sRUFBRSxHQUFvQixRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDN0MsSUFBSSxtQkFBbUIsR0FBYSxFQUFFLENBQUM7SUFFdkMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxVQUFDLE1BQU0sRUFBRSxJQUFJO1FBQ2hCLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsRUFBRSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ2hELENBQUMsQ0FBQyxDQUFDO0lBQ0gsRUFBRSxDQUFDLEdBQUcsQ0FBQyxVQUFDLE1BQU0sRUFBRSxJQUFJO1FBRWhCLHVCQUFvQixDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsRUFBRSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ25ELENBQUMsQ0FBQyxDQUFBO0lBR0YsRUFBRSxDQUFDLEVBQUUsQ0FBQyxZQUFZLEVBQUUsVUFBQyxNQUFjO1FBQy9CLG1CQUFtQixDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNwRCxPQUFPLENBQUMsR0FBRyxDQUFDLGlCQUFpQixFQUFFLG1CQUFtQixDQUFDLENBQUM7UUFDcEQsRUFBRSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1FBRWhELE1BQU0sQ0FBQyxFQUFFLENBQUMsWUFBWSxFQUFFO1lBQ3BCLG1CQUFtQixDQUFDLE1BQU0sQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDdEYsRUFBRSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1FBQ3BELENBQUMsQ0FBQyxDQUFDO1FBRUgsTUFBTSxDQUFDLEVBQUUsQ0FBQyxTQUFTLEVBQUUsVUFBQyxPQUEwQztZQUM1RCxPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3JCLElBQUksQ0FBQyxHQUFhLElBQUksb0JBQU8sQ0FBQztnQkFDMUIsT0FBTyxFQUFFLE9BQU8sQ0FBQyxPQUFPO2dCQUN4QixJQUFJLEVBQUUsT0FBTyxDQUFDLElBQUk7Z0JBQ2xCLFNBQVMsRUFBRSxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLO2FBQ3ZDLENBQUMsQ0FBQztZQUNILENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsVUFBQyxDQUFXO2dCQUN0QixFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRTtvQkFDZixHQUFHLEVBQUUsQ0FBQyxDQUFDLEdBQUc7b0JBQ1YsU0FBUyxFQUFFLENBQUMsQ0FBQyxTQUFTO29CQUN0QixJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUk7b0JBQ1osT0FBTyxFQUFFLENBQUMsQ0FBQyxPQUFPO29CQUNsQixPQUFPLEVBQUUsQ0FBQyxDQUFDLFNBQVM7aUJBQ3ZCLENBQUMsQ0FBQztnQkFDSCxNQUFNLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFDcEMsQ0FBQyxDQUFDLENBQUMsT0FBSyxDQUFBLENBQUMsVUFBQyxHQUFVO2dCQUNoQixPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNuQixNQUFNLENBQUMsSUFBSSxDQUFDLHVCQUF1QixFQUFFLEdBQUcsQ0FBQyxDQUFDO1lBQzlDLENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUNILE9BQU8sRUFBRSxDQUFDO0FBQ2QsQ0FBQyxDQUFBO0FBRUQscUJBQWUsSUFBSSxDQUFDIn0=","module.exports = require(\"socket.io\");"],"sourceRoot":""}